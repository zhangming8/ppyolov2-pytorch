#!/usr/bin/env bash

# train
#python train.py gpus='0' backbone="resnet_50" pretrained='torchvision://resnet_50' lr=0.001 lr_decay_epoch="20,40" batch_size=24 num_epochs=100 exp_id="res50_512x512_coco" input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 horizon_flip=0.5 rot_angle=2
#python train.py gpus='0' backbone="resnet_50" pretrained='torchvision://resnet_50' lr=0.001 lr_decay_epoch="20,50" batch_size=24 num_epochs=100 exp_id="res50_512x512_coco_dropBlock_spp" drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 horizon_flip=0.5 rot_angle=2
#python train.py gpus='0' backbone="resnet_50" pretrained='torchvision://resnet_50' lr=0.001 lr_decay_epoch="120,160" batch_size=24 num_epochs=200 exp_id="res50_512x512_coco_dropBlock_spp_warmup" use_amp=False drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 horizon_flip=0.5 rot_angle=2
# train with amp
#python train.py gpus='0' backbone="resnet_50" pretrained='torchvision://resnet_50' lr=0.0001 lr_decay_epoch="120,160" batch_size=18 num_epochs=200 exp_id="res50_512x512_coco_dropBlock_spp_warmup_amp" use_amp=True drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 horizon_flip=0.5 rot_angle=2
# RTX2080ti
#python train.py gpus='0' backbone="resnetvd_50" pretrained='../weights/ResNet50_vd_ssld_pretrained.pth' lr=0.005 lr_type="warmup_cosine" lr_decay_epoch=5 warmup_iters=9000 batch_size=12 accumulate=2 num_epochs=300 exp_id="resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic" use_amp=True drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 mosaic=0.3 horizon_flip=0.5 rot_angle=0
# RTX3090
python train.py gpus='0' backbone="resnetvd_50" pretrained='../weights/ResNet50_vd_ssld_pretrained.pth' lr=0.005 lr_type="warmup_cosine" lr_decay_epoch=10 warmup_iters=9000 batch_size=32 num_workers=16 accumulate=2 num_epochs=300 exp_id="resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic_noGrad" use_amp=True drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 mosaic=0.3 horizon_flip=0.5 rot_angle=0
# load pretrain checkpoint
#python train.py gpus='0' backbone="resnetvd_50" pretrained=None load_model="exp/resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic_noGrad/model_best_26.pth" resume=False lr=0.01 lr_type="warmup_cosine" lr_decay_epoch=5 warmup_iters=9000 batch_size=32 num_workers=16 accumulate=2 num_epochs=300 exp_id="resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic_noGrad" use_amp=True drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 mosaic=0.3 horizon_flip=0.5 rot_angle=0
# resume checkpoint, epoch
#python train.py gpus='0' backbone="resnetvd_50" pretrained=None load_model="exp/resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic_noGrad/model_best_26.pth" resume=True lr=0.005 lr_type="warmup_cosine" lr_decay_epoch=5 warmup_iters=9000 batch_size=32 num_workers=16 accumulate=2 num_epochs=300 exp_id="resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic_noGrad" use_amp=True drop_block=True spp=True input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 mosaic=0.3 horizon_flip=0.5 rot_angle=0
# resume checkpoint, optimizer, scaler, epoch
#python train.py gpus='0' backbone="resnet_50" load_model="exp/resvdDCN50_512x512_coco_dropBlock_spp_warmupCosine_amp_mosaic_noGrad/model_last.pth" resume=True lr=0.001 lr_decay_epoch="20,40" batch_size=24 num_epochs=100 exp_id="res50_512x512_coco" input_h=512 input_w=512 data_dir="/data/dataset/coco_dataset" val_intervals=1 horizon_flip=0.5 rot_angle=0
